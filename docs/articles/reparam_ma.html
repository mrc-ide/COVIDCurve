<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reparameterization of Age-Specific IFRs • CurveAware</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Reparameterization of Age-Specific IFRs">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CurveAware</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/installation.html">Installation</a>
    </li>
    <li>
      <a href="../articles/inferringI0.html">Inferring I0</a>
    </li>
    <li>
      <a href="../articles/inferringma.html">Inferring Age-Specific IFRs</a>
    </li>
    <li>
      <a href="../articles/reparam_ma.html">Reparameterization of Age-Specific IFRs</a>
    </li>
    <li>
      <a href="../articles/updateLL.html">Updating the Likelihood and Prior for Your Project</a>
    </li>
    <li>
      <a href="../articles/timeseries.html">Time-Series Extension</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nickbrazeau/CurveAware">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="reparam_ma_files/header-attrs-2.1/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Reparameterization of Age-Specific IFRs</h1>
            
      
      
      <div class="hidden name"><code>reparam_ma.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(CurveAware)</span></code></pre></div>
<div id="scenario" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario" class="anchor"></a>Scenario</h2>
<p>Here we will extend the <a href="">Inferring the IFRs Scenario</a> by assuming that we four age-specific IFRs. However, we suspect that these age-specific IFRs are very collinear. Given this collinearity, we assume that the IFRs can be represented as linear combinations of the largest IFR, and we instead fit these scalars, <span class="math inline">\(r_{1:3}\)</span>, instead of the age-specific IFRs. Given that we are fitting ‘scalars’ instead of the actual IFRs, we must reparameterize our posteriors at the end of the MCMC while also accounting for the reparamterization in our likelihood-prior calculation.</p>
<div id="simulating-data" class="section level3">
<h3 class="hasAnchor">
<a href="#simulating-data" class="anchor"></a>Simulating Data</h3>
<p>As before, we will simulate the number of deaths for day 50 of an epidemic where we have <strong>strong prior knowledge</strong> that the initial number of infected indvididuals (<span class="math inline">\(I_0\)</span>) was 2 individuals (along with our other previous assumptions).</p>
<p>We will simulate that the <span class="math inline">\(m_{a1}\)</span>, <span class="math inline">\(m_{a2}\)</span>, <span class="math inline">\(m_{a3}\)</span>, and <span class="math inline">\(m_{a4}\)</span> are 0.1, 0.2, 0.3, and 0.5, respectively, but our model will reflect that we have <strong>no prior knowledge</strong> of this true value.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>casefat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">age =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"1:25"</span>, <span class="st">"25:50"</span>, <span class="st">"50:75"</span>, <span class="st">"75:100"</span>),</span>
<span id="cb2-2"><a href="#cb2-2"></a>                      <span class="dt">cfr =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>),</span>
<span id="cb2-3"><a href="#cb2-3"></a>                      <span class="dt">pa =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb2-4"><a href="#cb2-4"></a></span>
<span id="cb2-5"><a href="#cb2-5"></a>simdat &lt;-<span class="st"> </span>CurveAware<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/CurveAware/man/sim_infxn_2_death_cumulative.html">sim_infxn_2_death_cumulative</a></span>(</span>
<span id="cb2-6"><a href="#cb2-6"></a>  <span class="dt">casefat =</span> casefat,</span>
<span id="cb2-7"><a href="#cb2-7"></a>  <span class="dt">I0 =</span> <span class="dv">2</span>,</span>
<span id="cb2-8"><a href="#cb2-8"></a>  <span class="dt">r =</span> <span class="fl">0.14</span>,</span>
<span id="cb2-9"><a href="#cb2-9"></a>  <span class="dt">m_od =</span> <span class="fl">18.8</span>,</span>
<span id="cb2-10"><a href="#cb2-10"></a>  <span class="dt">s_od =</span> <span class="fl">0.45</span>,</span>
<span id="cb2-11"><a href="#cb2-11"></a>  <span class="dt">curr_day =</span> <span class="dv">50</span>)</span></code></pre></div>
<p>The cumulative case data simulation output is a named vector of the total number of deaths:</p>
<table class="table">
<thead><tr class="header">
<th align="left">AgeGroups</th>
<th align="right">Deaths</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1:25</td>
<td align="right">49</td>
</tr>
<tr class="even">
<td align="left">25:50</td>
<td align="right">93</td>
</tr>
<tr class="odd">
<td align="left">50:75</td>
<td align="right">143</td>
</tr>
<tr class="even">
<td align="left">75:100</td>
<td align="right">254</td>
</tr>
</tbody>
</table>
</div>
<div id="running-the-model" class="section level3">
<h3 class="hasAnchor">
<a href="#running-the-model" class="anchor"></a>Running the Model</h3>
<p>Here we will load the Cumulative Likelihood and the “strong I0” prior from our <code>LogLikePrior_Catalog</code>. It is important to note, that users will need to update and adapt the likelihood and prior inputs to reflect their project structure. Please see the [Updating the Likelihood and Prior for Your Project] site for further details on recommended project-specific adaptations. You will also need to specify a dataframe of your “free” parameters as described in the <a href="https://github.com/mrc-ide/drjacoby/blob/master/vignettes/"><code>drjacoby</code> vignettes</a>. and a “misc-list” that contains the putative current day of the epidemic and the probability of infection given age, <span class="math inline">\(p_a\)</span>, for each age group (see above).</p>
<div id="adapting-our-likelihood-and-prior" class="section level4">
<h4 class="hasAnchor">
<a href="#adapting-our-likelihood-and-prior" class="anchor"></a>Adapting our Likelihood and Prior</h4>
<p>Here we will adaot the Cumulative Likelihood and the “strong I0” prior from our <code>LogLikePrior_Catalog</code> to reflect our updated age-specific IRFs and to account for the reparameterization. Please see the <a href="">Updating the Likelihood and Prior for Your Project</a> site for further details on recommended project-specific adaptations.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>r_strongI0_prior &lt;-<span class="st"> </span><span class="cf">function</span>(params, param_i, misc) {</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a>  I0 &lt;-<span class="st"> </span>params[<span class="st">"I0"</span>]</span>
<span id="cb3-4"><a href="#cb3-4"></a>  r1 &lt;-<span class="st"> </span>params[<span class="st">"r1"</span>]</span>
<span id="cb3-5"><a href="#cb3-5"></a>  r2 &lt;-<span class="st"> </span>params[<span class="st">"r2"</span>]</span>
<span id="cb3-6"><a href="#cb3-6"></a>  r3 &lt;-<span class="st"> </span>params[<span class="st">"r3"</span>]</span>
<span id="cb3-7"><a href="#cb3-7"></a>  ma4 &lt;-<span class="st"> </span>params[<span class="st">"ma4"</span>]</span>
<span id="cb3-8"><a href="#cb3-8"></a></span>
<span id="cb3-9"><a href="#cb3-9"></a>  <span class="co"># get prior</span></span>
<span id="cb3-10"><a href="#cb3-10"></a>  ret &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Lognormal.html">dlnorm</a></span>(I0, <span class="dt">meanlog =</span> <span class="fl">0.69</span>, <span class="dt">sdlog =</span> <span class="fl">0.05</span>, <span class="dt">log =</span> <span class="ot">TRUE</span>) <span class="op">+</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="st">    </span><span class="kw"><a href="https://rdrr.io/r/stats/Uniform.html">dunif</a></span>(r1, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">1</span>, <span class="dt">log =</span> <span class="ot">TRUE</span>) <span class="op">+</span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="st">    </span><span class="kw"><a href="https://rdrr.io/r/stats/Uniform.html">dunif</a></span>(r2, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">1</span>, <span class="dt">log =</span> <span class="ot">TRUE</span>) <span class="op">+</span></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="st">    </span><span class="kw"><a href="https://rdrr.io/r/stats/Uniform.html">dunif</a></span>(r3, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">1</span>, <span class="dt">log =</span> <span class="ot">TRUE</span>) <span class="op">+</span></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="st">    </span><span class="kw"><a href="https://rdrr.io/r/stats/Uniform.html">dunif</a></span>(ma4, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">1</span>, <span class="dt">log =</span> <span class="ot">TRUE</span>) <span class="op">+</span></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="st">    </span><span class="dv">3</span><span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(ma4) <span class="co"># account for reparameterization</span></span>
<span id="cb3-16"><a href="#cb3-16"></a></span>
<span id="cb3-17"><a href="#cb3-17"></a>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(ret)</span>
<span id="cb3-18"><a href="#cb3-18"></a>}</span>
<span id="cb3-19"><a href="#cb3-19"></a></span>
<span id="cb3-20"><a href="#cb3-20"></a>r_cumulative_likelihood &lt;-<span class="st"> </span><span class="cf">function</span>(params, param_i, data, misc) {</span>
<span id="cb3-21"><a href="#cb3-21"></a></span>
<span id="cb3-22"><a href="#cb3-22"></a>  <span class="co"># from Verity Lancet ID manuscript</span></span>
<span id="cb3-23"><a href="#cb3-23"></a>  m_od &lt;-<span class="st"> </span><span class="fl">18.8</span></span>
<span id="cb3-24"><a href="#cb3-24"></a>  r &lt;-<span class="st"> </span><span class="fl">0.14</span></span>
<span id="cb3-25"><a href="#cb3-25"></a>  s_od &lt;-<span class="st"> </span><span class="fl">0.45</span></span>
<span id="cb3-26"><a href="#cb3-26"></a></span>
<span id="cb3-27"><a href="#cb3-27"></a>  <span class="co"># store misc item for integral</span></span>
<span id="cb3-28"><a href="#cb3-28"></a>  curr_day &lt;-<span class="st"> </span>misc<span class="op">$</span>curr_day</span>
<span id="cb3-29"><a href="#cb3-29"></a></span>
<span id="cb3-30"><a href="#cb3-30"></a>  <span class="co"># free params</span></span>
<span id="cb3-31"><a href="#cb3-31"></a>  ma4 &lt;-<span class="st"> </span>params[<span class="st">"ma4"</span>]</span>
<span id="cb3-32"><a href="#cb3-32"></a>  r1 &lt;-<span class="st"> </span>params[<span class="st">"r1"</span>]</span>
<span id="cb3-33"><a href="#cb3-33"></a>  r2 &lt;-<span class="st"> </span>params[<span class="st">"r2"</span>]</span>
<span id="cb3-34"><a href="#cb3-34"></a>  r3 &lt;-<span class="st"> </span>params[<span class="st">"r3"</span>]</span>
<span id="cb3-35"><a href="#cb3-35"></a>  I0 &lt;-<span class="st"> </span>params[<span class="st">"I0"</span>]</span>
<span id="cb3-36"><a href="#cb3-36"></a>  scalars &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(r1, r2, r3)</span>
<span id="cb3-37"><a href="#cb3-37"></a>  </span>
<span id="cb3-38"><a href="#cb3-38"></a>  <span class="co"># get age specific mortality</span></span>
<span id="cb3-39"><a href="#cb3-39"></a>  ma &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(scalars, <span class="cf">function</span>(x){x <span class="op">*</span><span class="st"> </span>ma4})</span>
<span id="cb3-40"><a href="#cb3-40"></a>  ma &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(ma, ma4)</span>
<span id="cb3-41"><a href="#cb3-41"></a></span>
<span id="cb3-42"><a href="#cb3-42"></a>  <span class="co"># integrate for expected incidence mapped onto onset-death time lag</span></span>
<span id="cb3-43"><a href="#cb3-43"></a>  integrand &lt;-<span class="st"> </span><span class="cf">function</span>(t, <span class="dt">gr =</span> r){ <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(</span>
<span id="cb3-44"><a href="#cb3-44"></a>    I0 <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(gr<span class="op">*</span>t) <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/GammaDist.html">pgamma</a></span>(curr_day <span class="op">-</span><span class="st"> </span>t, <span class="dt">shape =</span> <span class="dv">1</span><span class="op">/</span>s_od<span class="op">^</span><span class="dv">2</span>, <span class="dt">scale =</span> m_od<span class="op">*</span>s_od<span class="op">^</span><span class="dv">2</span>)) }</span>
<span id="cb3-45"><a href="#cb3-45"></a>  integral &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/integrate.html">integrate</a></span>(integrand, <span class="dt">lower =</span> <span class="op">-</span><span class="ot">Inf</span>, <span class="dt">upper =</span> curr_day)</span>
<span id="cb3-46"><a href="#cb3-46"></a></span>
<span id="cb3-47"><a href="#cb3-47"></a>  <span class="co"># total exp deaths</span></span>
<span id="cb3-48"><a href="#cb3-48"></a>  exp.deaths &lt;-<span class="st"> </span>misc<span class="op">$</span>pa <span class="op">*</span><span class="st"> </span>ma <span class="op">*</span><span class="st"> </span>integral<span class="op">$</span>value</span>
<span id="cb3-49"><a href="#cb3-49"></a></span>
<span id="cb3-50"><a href="#cb3-50"></a>  <span class="co"># poisson LL</span></span>
<span id="cb3-51"><a href="#cb3-51"></a>  ret &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span>(<span class="dt">x =</span> data<span class="op">$</span>obs_deaths, <span class="dt">lambda =</span> exp.deaths, <span class="dt">log =</span> T))</span>
<span id="cb3-52"><a href="#cb3-52"></a>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(ret)</span>
<span id="cb3-53"><a href="#cb3-53"></a></span>
<span id="cb3-54"><a href="#cb3-54"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># params</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>df_params &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">name =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"r1"</span>, <span class="st">"r2"</span>, <span class="st">"r3"</span>, <span class="st">"ma4"</span>, <span class="st">"I0"</span>),</span>
<span id="cb4-3"><a href="#cb4-3"></a>                        <span class="dt">min =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb4-4"><a href="#cb4-4"></a>                        <span class="dt">init =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="dv">2</span>),</span>
<span id="cb4-5"><a href="#cb4-5"></a>                        <span class="dt">max =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">10</span>))</span>
<span id="cb4-6"><a href="#cb4-6"></a></span>
<span id="cb4-7"><a href="#cb4-7"></a>misclist &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">curr_day =</span> <span class="dv">50</span>, </span>
<span id="cb4-8"><a href="#cb4-8"></a>                 <span class="dt">pa =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span>))</span>
<span id="cb4-9"><a href="#cb4-9"></a></span>
<span id="cb4-10"><a href="#cb4-10"></a>r_mcmc_out &lt;-<span class="st"> </span>CurveAware<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/CurveAware/man/wrap_drjacoby_mcmc.html">wrap_drjacoby_mcmc</a></span>(</span>
<span id="cb4-11"><a href="#cb4-11"></a>                                    <span class="dt">data =</span> simdat,</span>
<span id="cb4-12"><a href="#cb4-12"></a>                                    <span class="dt">level =</span> <span class="st">"Cumulative"</span>,</span>
<span id="cb4-13"><a href="#cb4-13"></a>                                    <span class="dt">df_params =</span> df_params,</span>
<span id="cb4-14"><a href="#cb4-14"></a>                                    <span class="dt">misc =</span> misclist,</span>
<span id="cb4-15"><a href="#cb4-15"></a>                                    <span class="dt">LogLike =</span> r_cumulative_likelihood,</span>
<span id="cb4-16"><a href="#cb4-16"></a>                                    <span class="dt">LogPrior =</span> r_strongI0_prior,</span>
<span id="cb4-17"><a href="#cb4-17"></a>                                    <span class="dt">burnin =</span> <span class="fl">1e3</span>,</span>
<span id="cb4-18"><a href="#cb4-18"></a>                                    <span class="dt">samples =</span> <span class="fl">1e3</span></span>
<span id="cb4-19"><a href="#cb4-19"></a>                                  )</span></code></pre></div>
<p>Now that the model has finished fitting, we need to transform our posterior distributions to reflect the IFRs.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>reparcols &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"r[0-9]"</span>, <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(r_mcmc_out<span class="op">$</span>output))</span>
<span id="cb5-2"><a href="#cb5-2"></a>params_repar &lt;-<span class="st"> </span>r_mcmc_out<span class="op">$</span>output[, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(reparcols <span class="op">|</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(r_mcmc_out<span class="op">$</span>output) <span class="op">==</span><span class="st"> "ma4"</span>)]</span>
<span id="cb5-3"><a href="#cb5-3"></a>reparcols &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"r[0-9]"</span>, <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(params_repar))</span>
<span id="cb5-4"><a href="#cb5-4"></a>params_repar &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(params_repar[, reparcols], <span class="dv">2</span>,</span>
<span id="cb5-5"><a href="#cb5-5"></a>                      <span class="cf">function</span>(x){params_repar<span class="op">$</span>ma4 <span class="op">*</span><span class="st"> </span>x})</span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(params_repar) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"ma"</span>, <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(reparcols))</span>
<span id="cb5-7"><a href="#cb5-7"></a>r_mcmc_out<span class="op">$</span>output &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind.data.frame</a></span>(r_mcmc_out<span class="op">$</span>output, params_repar)</span></code></pre></div>
<p>As before, we can explore the posterior distributions using plotting functions in <code>drjacoby</code>, namely: <code><a href="https://rdrr.io/pkg/drjacoby/man/plot_par.html">drjacoby::plot_par()</a></code> and <code><a href="https://rdrr.io/pkg/drjacoby/man/plot_cor.html">drjacoby::plot_cor()</a></code>. For further discussions on MCMC diagnostics and assessing MCMC convergence please see the <a href="https://github.com/mrc-ide/drjacoby/blob/master/vignettes/"><code>drjacoby</code> vignettes</a>.</p>
<p>Below, the posterior distribution is shown with the simulated true value indicated in as a red line for each free parameter.</p>
<p><br></p>
<p><img src="reparam_ma_files/figure-html/unnamed-chunk-7-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#scenario">Scenario</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Nick Brazeau, Bob Verity.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
